/**
 * Side module
 *
 * Encompasses sidebar
 */

#side {
  @include reset(padding);
  @include dimensions(0);
}

// Hide all widgets
.widget {
  display: none;
}

// User widget
#user-menu-widget {
  font-size: 0.01px;

  p {
    display: none;
  }

  .avatar {
    position: absolute;
    display: block;
    margin-left: -2.5rem;

    @include position(-2.6rem, 50%);

    img {
      background-color: $bgSub;
      display: block;
      color: $t;
      border-radius: 50%;
      border: 1px solid $bgSub;

      @include dimensions(5rem);
    }
  }

  strong a {
    @include extend('%heading');

    position: absolute;
    display: block;

    font-size: 0.8rem;
    text-overflow: ellipsis;
    color: $t;
    line-height: 5rem;

    border-radius: 50%;
    padding: 0.2rem;
    margin-left: -2.5rem;
    overflow: hidden;
    z-index: 1;

    transition: 0.15s 0.02s ease-in;

    @include position(-2.7rem, 50%);
    @include dimensions(4.8rem);

    &::after {
      content: "";
      position: absolute;

      background-image: linear-gradient(
        to bottom,
        $t,
        $t 30%,
        transparentize($ovrHeader, 0.7)
      );
      background-position: 50% 0;
      opacity: 0;
      z-index: -1;

      transition: 0.25s ease-out;

      @include position(0);
    }

    &:hover {
      color: $fgHeader;
      text-shadow: 1px 1px 1px transparentize($ovrHeader, 0.4);

      &::after {
        opacity: 1;
      }
    }
  }
}

// Search widget
.widget:not([id]) {
  display: block;
  z-index: 10;

  .widget-header,
  .widget-content div {
    display: none;
  }
}

#blog_keywords {
  @include extend('%heading');
  @include extend('%transition03');

  position: fixed;
  top: 0;
  right: 0;
  display: block;

  background-color: $t;

  color: lighten($ovrHeader, 30%);
  // we need the important flag as the scss compiler messes with placeholder
  // extends, creating a #blog_keywords[type="text"] rule with border-color
  // set to lighten($bgSub, 5%)
  border-left: 1.6em solid $fgHeader !important;
  z-index: 11;
  cursor: pointer;

  transition:
    all 0s linear,
    width 0.4s ease,
    background-color 0s linear 0.4s;

  @include reset((border, box-shadow, border-radius));
  @include dimensions(0, 3em);

  &:focus {
    @extend :hover;

    width: 15em;
    background-color: lighten($bgSub, 15%);
    color: $ovrHeader;
    padding-left: 0.5em;
    padding-right: 3.1em;
    border-left: none !important;
    cursor: auto;

    transition:
      all 0s linear,
      width 0.3s ease,
      background-color 0s linear;
  }

  + div {
    @include extend('%border-box');

    position: fixed;
    top: -3px; // counteract inline margin
    right: 0;

    background-color: $t;
    display: block;
    font-size: 0;
    overflow: hidden;
    pointer-events: none;
    z-index: 11;

    // Preserve the symmetry of the icon by adding a camoflauged border-right
    border-right: 0.2rem solid $fgHeader;

    transition:
      background-color 0.3s ease 0.13s,
      border-right-color 0.3s ease 0.13s;

    @include dimensions(2.6rem, 3rem);

    // Similar to the BCP link, the icon covers the bottom border in Chrome
    @include no-prefix { border-bottom: -webkit-calc(1px) solid lighten($bgSub, 13%); }
  }
  // Hide submit button
  + div input {
    display: none;
  }

  // Search icon
  //
  // div::before - the circle/magnifier
  // div::after - the handle
  + div::before,
  + div::after {
    @include extend('%border-box');
    @include extend('%pseudo');

    background-color: $t;

    @include position(1rem, 0.7rem);
    @include dimensions(0.8rem);
  }
  + div::before {
    border: 1px solid $ovrHeader;
    border-radius: 1rem;
  }
  + div::after {
    background-color: $ovrHeader;
    transform: rotate(-40deg);

    @include position(1.6rem, 1.5rem);
    @include dimensions(1.4px, 0.6rem);

    @include no-prefix { width: -webkit-calc(1px); } // Handle gets too thick in Chrome
  }
  &:hover + div {
    background-color: lighten($bgSub, 16%);

    transition: background-color 0.3s ease;
  }
  &:focus + div {
    background-color: lighten($bgSub, 15%);
    border-right-color: lighten($bgSub, 15%);

    transition:
      background-color 0.3s ease,
      border-right-color 0.3s ease;
  }
}
